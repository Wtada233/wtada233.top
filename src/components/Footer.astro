---
import { profileConfig } from "@configs/profile";
import I18nKey from "@i18n/i18nKey";
import { i18n } from "@i18n/translation";
import { getLangFromPathname } from "@utils/i18n-runtime";
import { url } from "@utils/url-utils";

const currentYear = new Date().getFullYear();

// Get current lang from URL
const lang = getLangFromPathname(Astro.url.pathname);

// 从环境变量获取构建日期，确保在构建时可用
// PUBLIC_BUILD_DATE 环境变量将在 astro.config.mjs 中设置
const buildDate = import.meta.env.PUBLIC_BUILD_DATE || new Date().toISOString();
const formattedBuildDate = new Date(buildDate).toLocaleDateString(lang.replace("_", "-"), {
	year: "numeric",
	month: "long",
	day: "numeric",
	hour: "2-digit",
	minute: "2-digit",
});
---

<div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-8 md:mx-32"></div>
<div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6">
    <div class="transition text-50 text-sm text-center">
        <div class="translation-unit">
            &copy; <span id={`copyright-year`}>{currentYear}</span> {profileConfig.name}. {i18n(I18nKey.license, {}, lang)}. /
            <a class="transition link text-[var(--primary)] font-medium" href={url('rss/', lang)}>RSS</a>
            <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('sitemap-index.xml')}>Sitemap</a><br>
            Powered by
            <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
            <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a>
            <br>
            <span class="text-[var(--primary)]">{i18n(I18nKey.lastBuildAt, {}, lang)} {formattedBuildDate}</span>
        </div>
    </div>
</div>
